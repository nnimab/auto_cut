# 自動影片剪輯工具

這是一個基於Python的自動影片剪輯工具，專門用於從影片中自動識別並提取動作幅度較大的片段。特別適合處理座談、演講、教學等固定視角的影片，能夠自動找出其中動作較多的精彩片段。

## 主要功能

- 自動檢測影片中的動作幅度
- 識別並提取動作較大的片段（預設每段1分鐘）
- 自動將選出的片段分別儲存（預設選取5個最佳片段）
- 保持影片的音畫同步
- 提供簡潔的圖形用戶界面
- 即時顯示處理進度

## 使用場景

- 教學影片剪輯：自動提取老師動作較多的講解片段
- 演講影片精華：擷取演講者肢體語言豐富的段落
- 座談會重點摘要：找出與會者互動較多的時刻
- 一般影片剪輯：提取動態較強的片段

## 技術需求

- Python 3.8+
- OpenCV：用於影像處理和動作檢測
- MoviePy：用於影片剪輯
- NumPy：用於數據處理
- PyQt6：用於圖形界面

## 安裝方法

1. 克隆此專案
2. 安裝依賴套件：
```bash
pip install -r requirements.txt
```

## 使用方法

1. 運行主程式：
```bash
python main.py
```

2. 在彈出的界面中：
   - 點擊「選擇影片檔案」按鈕
   - 選擇要處理的影片檔案（支援 mp4、avi、mov、mkv 格式）
   - 點擊「開始處理」按鈕
   - 等待處理完成

3. 輸出結果：
   - 程式會在原影片所在目錄建立一個新資料夾（原檔名+'_clips'）
   - 資料夾內會包含多個剪輯片段（clip_01.mp4、clip_02.mp4 等）
   - 片段按照動作幅度大小排序，編號越小代表動作幅度越大

## 工作原理

1. 影片分析：
   - 使用OpenCV的光流法檢測每一幀的動作
   - 計算並記錄動作幅度分數
   
2. 片段選擇：
   - 將影片分割成固定時長的片段（預設1分鐘）
   - 計算每個片段的平均動作分數
   - 選出分數最高的片段（預設5個）

3. 影片輸出：
   - 將選中的片段分別儲存為獨立檔案
   - 保持原始影片的畫質和音訊

## 注意事項

- 處理時間取決於影片長度和電腦效能
- 建議在固定視角的影片上使用
- 輸出的影片片段會按照動作幅度大小排序
- 確保有足夠的硬碟空間存放輸出檔案 